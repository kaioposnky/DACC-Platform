<?xml version="1.0" encoding="utf-8"?>
<queries>
    <query name="GetCupomByCodigo">
        SELECT
            id as Id,
            codigo as Codigo,
            tipo_desconto as TipoDesconto,
            valor as Valor,
            data_expiracao as DataExpiracao,
            limite_uso as LimiteUso,
            uso_atual as UsoAtual,
            ativo as Ativo,
            data_criacao as DataCriacao
        FROM cupom
        WHERE codigo = @Codigo AND ativo = true;
    </query>

    <query name="IncrementarUsoCupom">
        UPDATE cupom
        SET uso_atual = uso_atual + 1
        WHERE id = @Id;
    </query>

    <query name="GetAllCupons">
        SELECT * FROM cupom ORDER BY data_criacao DESC;
    </query>

    <query name="CreateCupom">
        INSERT INTO cupom (codigo, tipo_desconto, valor, data_expiracao, limite_uso)
        VALUES (@Codigo, @TipoDesconto, @Valor, @DataExpiracao, @LimiteUso)
        RETURNING id;
    </query>

    <query name="DeleteCupom">
        DELETE FROM cupom WHERE id = @Id;
    </query>
</queries>
